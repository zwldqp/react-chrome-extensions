# [Lamma UI](http://design.4pd.io)

先知平台前端组件库。

文档：[http://design.4pd.io](http://design.4pd.io)

## 使用组件库

```bash
npm i lamma-ui  # 安装组件库
```

### 1. 引入组件库样式

只需在入口文件处引入一次即可

```javascript
import 'lamma-ui/dist/lamma-ui.css'
```

### 2. 使用组件

```javascript
import {
    Input,
    Table,
} from 'lamma-ui'
```

或者：

```javascript
import Input from 'lamma-ui/lib/input/input'
import Table from 'lamma-ui/lib/input/input'
```

## 开始开发组件

### 准备

```bash
git clone git@git.4paradigm.com:fe/lamma-ui.git
npm install # 安装依赖
```

### 新建一个组件

```bash
npm run new COMPONENT_NAME # COMPONENT_NAME 为组件名
```

如下新建一个 `Table` 组件：

```bash
npm run new Table
# 或者
npm run new table
# 或者
npm run new my-component  # MyComponent
```

命令执行完成以后会在 `component` 目录下创建如下目录结构：

```text
.
├── table
    ├── __test__               # 单元测试
    │   └── table.test.jsx
    ├── demo                   # Demo 目录
    │   └── basic.jsx          # Demo 文件
    ├── table.jsx              # Table 组件入口文件
    └── table.less             # Table 组件样式文件
```

**注意：** `npm run new ` 命令在创建上面目录的同时，还会将组件信息自动插入到如下位置：

1. 在 `component/index.js` 中将组件导出。
2. 在 `less/index.less` 中引入组件的 less 文件，所以在开发组件时不要在 jsx 文件中引入样式文件。
3. 在 `doc/src/demo.jsx` 中引入组件，以确保 Demo 正常运行。

它能正确完成这部分工作是因为这些文件里有下面这行占位符：

```javascript
/* new component placeholder */
```

**所以，这行注释是千万不能删除的**

### 开发调试

```bash
npm run start

# 默认会关闭 ESLint，你可以通过 --lint 选项在开发时启用 ESLint，如：
npm run start -- --lint
```

执行改命令将启动 doc server，在浏览器打开：`http://localhost:3000` 即可查看所有组件库的文档。

你可以通过 `http://localhost:3000/<组件库目录名>.html` 直接进入要你要开发的组件文档页面。

#### 使用 Demo 来进行预览

开发中的组件是通过 Demo 的方式来预览的，组件通过 `npm run new` 来创建会默认生成一个 Demo 文件：`demo/basic.jsx`，该文件中你可以使用所有已完成的组件，但是你无需手动引入它们，同样 React、ReactDom 也是一样。

同样你也可以创建任意多的 Demo 文件来从不同场景展示该组件的使用方法。

组件的所有 Demo 都会在其对应的文档页面展示出来。

## 组件库文档

基于既有的工具，你无需刻意去编写组件的文档，需要做的只是给组件及其属性添加注释。

工具会自动获取组件的描述信息和属性列表并展示在组件详情页面。

```bash
npm run build-doc
```

执行该命令可以构建组件库文档，文档构建完成以后会输出到 `doc/dist` 目录中，直接作为静态网站部署即可。

### 组件库署名

组件的入口文件，在组件描述部分要设置 @author 注释，明确各个组件的负责人。

一定要写在组件的注释部分，而不是文件的最顶部。这样可以在直接文档中看到。

在第一次执行 `npm run new` 命令式，会询问你的名字，并把它记录在根目录的 author.json 的 name 字段中。

之后 `npm run new` 命令会自动帮你添加，如果你想修改，可以修改 author.json 文件，该文件已经被加到 `.gitignore` 中。

## 单元测试

```bash
npm run test
```

该命令会运行项目的测试用例，通过 `npm run new` 命令新建的组件，会默认生成一个测试文件 `__test__/<组件目录名>.test.js`，在开发组件的过程中，你可以完善该文件，或者在 `__test__` 目录中添加更多的测试代码文件。

项目使用 [Jest](https://facebook.github.io/jest/) 测试框架。

## 发布

```bash
npm run pub
```

该命令会执行如下7个步骤：

* 1. 静态检查 Lint
* 2. 单元测试 Jest
* 3. 构建 lib、dist 目录（Build）
* 4. 替换 package.json 中的 version 字段，并 git commit
* 5. 发布包，npm publish
* 6. git tag vx.x.x
* 7. git push && git push --tags

